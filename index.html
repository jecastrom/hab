<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Suche nach Gruppe oder Ring</title>
  <style>
    :root {
      --bg: #ffffff;
      --text: #000000;
      --card-bg: #f9f9f9;
      --border: #ccc;
      --header-bg: #f0f0f0;
      --button-bg: #007bff;
      --button-hover: #0056b3;
      --clear-bg: #6c757d;
      --clear-hover: #545b62;
      --th-bg: #f0f0f0;
    }

    body.dark-mode {
      --bg: #121212;
      --text: #e0e0e0;
      --card-bg: #1e1e1e;
      --border: #444;
      --header-bg: #1f1f1f;
      --button-bg: #0d6efd;
      --button-hover: #0b5ed7;
      --clear-bg: #495057;
      --clear-hover: #343a40;
      --th-bg: #2c2c2c;
    }

    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      max-width: 800px;
      margin: 0 auto;
      padding: 10px;
      background: var(--bg);
      color: var(--text);
      transition: background 0.3s, color 0.3s;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
    }

    h1 {
      font-size: 1.8em;
      margin: 0;
      text-align: left;
    }

    /* Toggle Switch */
    .theme-toggle {
      position: relative;
      display: inline-block;
      width: 60px;
      height: 34px;
    }

    .theme-toggle input { opacity: 0; width: 0; height: 0; }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 34px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 26px;
      width: 26px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }

    input:checked + .slider { background-color: #2196F3; }
    input:checked + .slider:before { transform: translateX(26px); }

    .slider svg {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      transition: opacity 0.3s;
    }

    .sun { left: 8px; fill: #ffd43b; opacity: 1; }
    .moon { right: 8px; fill: #f1c40f; opacity: 0; }
    body.dark-mode .sun { opacity: 0; }
    body.dark-mode .moon { opacity: 1; }

    label { display: block; margin-top: 15px; font-weight: bold; }
    select, input, button {
      width: 100%;
      padding: 8px;
      margin: 5px 0;
      box-sizing: border-box;
      font-size: 1em;
      background: var(--bg);
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 4px;
    }

    button {
      background: var(--button-bg);
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover { background: var(--button-hover); }

    #clearBtn { background: var(--clear-bg); }
    #clearBtn:hover { background: var(--clear-hover); }

    #status { text-align: center; margin-top: 20px; min-height: 24px; }

    .table-container { overflow-x: auto; margin-top: 20px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid var(--border); padding: 12px; text-align: left; }
    th { background: var(--th-bg); }

    .results-cards { display: none; margin-top: 20px; }
    .card {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 15px;
      background: var(--card-bg);
    }

    .card div { margin-bottom: 8px; }
    .card strong { display: inline-block; width: 140px; }

    @media (min-width: 768px) {
      .controls { display: flex; gap: 10px; align-items: end; }
      select, input { width: auto; flex: 1; padding: 10px; margin: 10px 0; }
      .button-group { display: flex; gap: 10px; }
      .button-group button { flex: 1; padding: 10px; }
      .results-cards { display: none !important; }
      .table-container { display: block; }
    }

    @media (max-width: 767px) {
      .table-container { display: none; }
      .results-cards { display: block; }
      .button-group { display: flex; gap: 5px; }
      .button-group button { flex: 1; padding: 8px; }
      header { flex-direction: row; align-items: center; }
      .theme-toggle { margin-top: 0; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Suche nach Gruppe oder Ring</h1>
    <div style="display: flex; align-items: center; gap: 20px;">
      <a href="admin.html" style="font-size: 0.9em; color: #007bff; text-decoration: none;">Admin</a>
      <label class="theme-toggle">
        <input type="checkbox" id="darkModeToggle">
        <span class="slider">
          <svg class="sun" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="5" />
            <line x1="12" y1="1" x2="12" y2="3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="12" y1="21" x2="12" y2="23" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="1" y1="12" x2="3" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="21" y1="12" x2="23" y2="12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          <svg class="moon" viewBox="0 0 24 24">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
          </svg>
        </span>
      </label>
    </div>
  </header>
  <div class="controls">
    <div>
      <label for="object">Objekt wählen:</label>
      <select id="object">
        <option value="hab">HAB</option>
        <option value="keh">KEH</option>
        <!-- Add more as needed -->
        <option value="test">Test Object</option>
        <option value="test">Test Object</option>
      </select>
    </div>
    <div>
      <label for="type">Suchtyp:</label>
      <select id="type">
        <option value="Gruppe">Gruppe</option>
        <option value="Ring">Ring</option>
      </select>
    </div>
    <div>
      <label for="value">Wert:</label>
      <input type="tel" id="value" placeholder="z. B. 101 oder 121" pattern="[0-9]*" inputmode="numeric">
    </div>
    <div class="button-group">
      <button onclick="search()">Suchen</button>
      <button id="clearBtn" onclick="clearSearch()">Löschen</button>
    </div>
  </div>
  <div id="status">Daten werden geladen...</div>
  <div id="results"></div>

  <script>
    let data = [];
    const statusDiv = document.getElementById('status');
    const resultsDiv = document.getElementById('results');
    // Map object keys to filenames
    const objectFiles = {
      hab: 'hab.json',
      keh: 'keh.json',
      test: 'test.json',
      test: 'test.json'
    };
    function loadData() {
      const object = document.getElementById('object').value;
      const filename = objectFiles[object];
      statusDiv.textContent = 'Daten werden geladen...';
      resultsDiv.innerHTML = '';
      data = [];
      fetch(filename)
        .then(response => {
          if (!response.ok) {
            throw new Error('Datei nicht gefunden');
          }
          return response.json();
        })
        .then(json => {
          data = json;
          statusDiv.textContent = `Daten geladen: ${data.length} Einträge (${object.toUpperCase()})`;
        })
        .catch(err => {
          data = [];
          statusDiv.innerHTML = '<p style="color:red;">Keine Daten verfügbar. Bitte die JSON-Datei hinzufügen.</p>';
        });
    }
    // Load data when object changes
    document.getElementById('object').addEventListener('change', loadData);
    // Initial load (HaB)
    loadData();
    // Dark mode
    const toggle = document.getElementById('darkModeToggle');
    const body = document.body;
    if (localStorage.getItem('darkMode') === 'enabled') {
      body.classList.add('dark-mode');
      toggle.checked = true;
    }
    toggle.addEventListener('change', () => {
      if (toggle.checked) {
        body.classList.add('dark-mode');
        localStorage.setItem('darkMode', 'enabled');
      } else {
        body.classList.remove('dark-mode');
        localStorage.setItem('darkMode', 'disabled');
      }
    });
    // Enter key search
    document.getElementById('value').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        search();
      }
    });
    function search() {
      const type = document.getElementById('type').value;
      const value = document.getElementById('value').value.trim();
      resultsDiv.innerHTML = '';
      if (!value) {
        resultsDiv.innerHTML = '<p>Bitte eine Nummer eingeben.</p>';
        return;
      }
      if (data.length === 0) {
        resultsDiv.innerHTML = '<p>Keine Daten geladen. Bitte ein Objekt mit verfügbaren Daten auswählen.</p>';
        return;
      }
      const matches = data.filter(row => row[type] === value);
      if (matches.length === 0) {
        resultsDiv.innerHTML = '<p>Keine Ergebnisse gefunden.</p>';
        return;
      }
      let tableHTML = '<div class="table-container"><table><thead><tr>';
      if (type === 'Ring') {
        tableHTML += '<th>Ring</th><th>Installationsort</th><th>Gruppe</th><th>Anz. Melder</th>';
      } else {
        tableHTML += '<th>Gruppe</th><th>Installationsort</th><th>Ring</th><th>Anz. Melder</th>';
      }
      tableHTML += '</tr></thead><tbody>';
      let cardsHTML = '<div class="results-cards">';
      matches.forEach(row => {
        tableHTML += '<tr>';
        if (type === 'Ring') {
          tableHTML += `<td>${row.Ring || ''}</td><td>${row.Installationsort || ''}</td><td>${row.Gruppe || ''}</td><td>${row["Anz.Melder"] || ''}</td>`;
        } else {
          tableHTML += `<td>${row.Gruppe || ''}</td><td>${row.Installationsort || ''}</td><td>${row.Ring || ''}</td><td>${row["Anz.Melder"] || ''}</td>`;
        }
        tableHTML += '</tr>';
        cardsHTML += '<div class="card">';
        if (type === 'Ring') {
          cardsHTML += `<div><strong>Ring:</strong> ${row.Ring || ''}</div>`;
          cardsHTML += `<div><strong>Installationsort:</strong> ${row.Installationsort || ''}</div>`;
          cardsHTML += `<div><strong>Gruppe:</strong> ${row.Gruppe || ''}</div>`;
          cardsHTML += `<div><strong>Anz. Melder:</strong> ${row["Anz.Melder"] || ''}</div>`;
        } else {
          cardsHTML += `<div><strong>Gruppe:</strong> ${row.Gruppe || ''}</div>`;
          cardsHTML += `<div><strong>Installationsort:</strong> ${row.Installationsort || ''}</div>`;
          cardsHTML += `<div><strong>Ring:</strong> ${row.Ring || ''}</div>`;
          cardsHTML += `<div><strong>Anz. Melder:</strong> ${row["Anz.Melder"] || ''}</div>`;
        }
        cardsHTML += '</div>';
      });
      tableHTML += '</tbody></table></div>';
      cardsHTML += '</div>';
      resultsDiv.innerHTML = tableHTML + cardsHTML;
    }
    function clearSearch() {
      document.getElementById('type').value = 'Gruppe';
      document.getElementById('value').value = '';
      resultsDiv.innerHTML = '';
      document.getElementById('value').focus();
    }
  </script>
</body>
</html>

